compsci 514: algorithms for data science  Andrew McGregor  Lecture 20  0  
summary  Spectral Graph Partitioning • Focus on separating graphs with small but relatively balanced cuts. • Connection to second smallest eigenvector of graph Laplacian. • Today: Provable guarantees for stochastic block model.  1  
spectral clustering with guarantees  • To partition a graph, ﬁnd the eigenvector of the Laplacian with  the second smallest eigenvalue. Partition nodes based on whether corresponding value in eigenvector is positive/negative.  (cid:126)vn−1 =  arg min  (cid:126)v∈Rn,(cid:107)(cid:126)v(cid:107)=1,(cid:126)v T(cid:126)1=0  (cid:126)v T L(cid:126)v  2  
spectral clustering with guarantees  • To partition a graph, ﬁnd the eigenvector of the Laplacian with  the second smallest eigenvalue. Partition nodes based on whether corresponding value in eigenvector is positive/negative.  (cid:126)vn−1 =  arg min  (cid:126)v∈Rn,(cid:107)(cid:126)v(cid:107)=1,(cid:126)v T(cid:126)1=0  (cid:126)v T L(cid:126)v  • We argued this “should” partition graph along a small cut that  separates the graph into large pieces.  2  
spectral clustering with guarantees  • To partition a graph, ﬁnd the eigenvector of the Laplacian with  the second smallest eigenvalue. Partition nodes based on whether corresponding value in eigenvector is positive/negative.  (cid:126)vn−1 =  arg min  (cid:126)v∈Rn,(cid:107)(cid:126)v(cid:107)=1,(cid:126)v T(cid:126)1=0  (cid:126)v T L(cid:126)v  • We argued this “should” partition graph along a small cut that  separates the graph into large pieces.  • Haven’t given formal guarantees; it’s diﬃcult for general input  graphs. But can consider randoms “natural” graphs. . .  2  
stochastic block model  Stochastic Block Model (Planted Partition Model): Let Gn(p, q) be a distribution over graphs on n nodes, split randomly into two groups B and C , each with n/2 nodes. • Any two nodes in the same group are connected with probability p  (including self-loops).  • Any two nodes in diﬀerent groups are connected with prob. q < p. • Connections are independent.  3  
linear algebraic view  Let G be a stochastic block model graph drawn from Gn(p, q). • Let A ∈ Rn×n be the adjacency matrix of G , ordered in terms of  group ID.  Gn(p, q): stochastic block model distribution. B, C : groups with n/2 nodes each. Connections are independent with probability p between nodes in the same group, and probability q between nodes not in the same group.  4  
expected adjacency spectrum  Letting G be a stochastic block model graph drawn from Gn(p, q) and A ∈ Rn×n be its adjacency matrix. (E[A])i,j = p for i, j in same group, (E[A])i,j = q otherwise.  Gn(p, q): stochastic block model distribution. B, C : groups with n/2 nodes each. Connections are independent with probability p between nodes in the same group, and probability q between nodes not in the same group.  5  
expected adjacency spectrum  Letting G be a stochastic block model graph drawn from Gn(p, q) and A ∈ Rn×n be its adjacency matrix. (E[A])i,j = p for i, j in same group, (E[A])i,j = q otherwise.  What is rank(E[A])? What are the eigenvectors and eigenvalues of E[A]?  Gn(p, q): stochastic block model distribution. B, C : groups with n/2 nodes each. Connections are independent with probability p between nodes in the same group, and probability q between nodes not in the same group.  5  
expected adjacency spectrum  If we compute (cid:126)v2 then we recover the communities B and C !  6  
expected adjacency spectrum  If we compute (cid:126)v2 then we recover the communities B and C ! • Can show that for G ∼ Gn(p, q), A is “close” to E[A] in some  appropriate sense (matrix concentration inequality).  6  
expected adjacency spectrum  If we compute (cid:126)v2 then we recover the communities B and C ! • Can show that for G ∼ Gn(p, q), A is “close” to E[A] in some • Second eigenvector of A is close to [1, 1, 1, . . . ,−1,−1,−1] and  appropriate sense (matrix concentration inequality).  gives a good estimate of the communities.  6  
expected adjacency spectrum  If we compute (cid:126)v2 then we recover the communities B and C ! • Can show that for G ∼ Gn(p, q), A is “close” to E[A] in some • Second eigenvector of A is close to [1, 1, 1, . . . ,−1,−1,−1] and  appropriate sense (matrix concentration inequality).  gives a good estimate of the communities.  When rows/columns aren’t sorted by ID, second eigenvector is e.g., [1,−1, 1,−1, . . . , 1, 1,−1] and entries give community ids.  6  
expected laplacian spectrum  Letting G be a stochastic block model graph drawn from Gn(p, q), A ∈ Rn×n be its adjacency matrix and L be its Laplacian, what are the eigenvectors and eigenvalues of E[L]?  7  
expected laplacian spectrum  Upshot: The second smallest eigenvector of E[L] is χB,C – the indicator vector for the cut between the communities.  8  
expected laplacian spectrum  Upshot: The second smallest eigenvector of E[L] is χB,C – the indicator vector for the cut between the communities. • If the matrices A and L were exactly equal to their expectation,  partitioning using this eigenvector (i.e., spectral clustering) would exactly recover the two communities B and C .  8  
expected laplacian spectrum  Upshot: The second smallest eigenvector of E[L] is χB,C – the indicator vector for the cut between the communities. • If the matrices A and L were exactly equal to their expectation,  partitioning using this eigenvector (i.e., spectral clustering) would exactly recover the two communities B and C .  How do we show that a matrix is close to its expectation? Matrix concentration inequalities. • Analogous to scalar concentration inequalities like Markovs,  Chebyshevs, Bernsteins.  • Random matrix theory is a very recent and cutting edge subﬁeld  of mathematics that is being actively applied in computer science, statistics, and ML.  8  
matrix concentration  Matrix Concentration Inequality: If p ≥ O high probability  √  (cid:107)A − E[A](cid:107)2 ≤ O(  pn).  (cid:16) log4 n  (cid:17)  n  , then with  where (cid:107) · (cid:107)2 is the matrix spectral norm (operator norm).  For any X ∈ Rn×d , (cid:107)X(cid:107)2 = maxz∈Rd :(cid:107)z(cid:107)2=1 (cid:107)Xz(cid:107)2.  9  
matrix concentration  Matrix Concentration Inequality: If p ≥ O high probability  √  (cid:107)A − E[A](cid:107)2 ≤ O(  pn).  (cid:16) log4 n  (cid:17)  n  , then with  where (cid:107) · (cid:107)2 is the matrix spectral norm (operator norm).  For any X ∈ Rn×d , (cid:107)X(cid:107)2 = maxz∈Rd :(cid:107)z(cid:107)2=1 (cid:107)Xz(cid:107)2. For the stochastic block model application, we want to show that the second eigenvectors of A and E[A] are close. How does this relate to their diﬀerence in spectral norm?  9  
eigenvector perturbation  Davis-Kahan Eigenvector Perturbation Theorem: Sup- pose A, A ∈ Rd×d are symmetric with (cid:107)A − A(cid:107)2 ≤  and eigenvectors v1, v2, . . . , vd and ¯v1, ¯v2, . . . , ¯vd . Letting θ(vi , ¯vi ) denote the angle between vi and ¯vi , for all i:  sin[θ(vi , ¯vi )] ≤    minj(cid:54)=i |λi − λj|  where λ1, . . . , λd are the eigenvalues of A.  The errors get large if there’s eigenvalues with similar magnitudes.  10  
application to stochastic block model  (cid:16) log4 n  (cid:17)  ,  n  Claim 1 (Matrix Concentration): For p ≥ O √  (cid:107)A − E[A](cid:107)2 ≤ O(  pn).  Claim 2 (Davis-Kahan): For p ≥ O  (cid:16) log4 n  (cid:17)  ,  n  sin θ(v2, ¯v2) ≤  √ O(  pn)  minj(cid:54)=i |λi − λj|  A adjacency matrix of random stochastic block model graph. p: connection probability within clusters. q < p: connection probability between clusters. n: number of nodes. v2, ¯v2: second eigenvectors of A and E[A] respectively.  11  
(cid:16) log4 n  (cid:17)  ,  n  Claim 1 (Matrix Concentration): For p ≥ O √  (cid:107)A − E[A](cid:107)2 ≤ O(  pn).  Claim 2 (Davis-Kahan): For p ≥ O  (cid:16) log4 n  (cid:17)  ,  n  application to stochastic block model  sin θ(v2, ¯v2) ≤  √ O(  pn)  minj(cid:54)=i |λi − λj|  Recall: E[A] has eigenvalues λ1 = (p+q)n i ≥ 3.  2  , λ2 = (p−q)n  2  , λi = 0 for  A adjacency matrix of random stochastic block model graph. p: connection probability within clusters. q < p: connection probability between clusters. n: number of nodes. v2, ¯v2: second eigenvectors of A and E[A] respectively.  11  
application to stochastic block model  (cid:16) log4 n  (cid:17)  ,  n  Claim 1 (Matrix Concentration): For p ≥ O √  (cid:107)A − E[A](cid:107)2 ≤ O(  pn).  Claim 2 (Davis-Kahan): For p ≥ O  sin θ(v2, ¯v2) ≤  √ O(  pn)  minj(cid:54)=i |λi − λj|  (cid:16) log4 n  (cid:17)  ,  n  (cid:18)  Recall: E[A] has eigenvalues λ1 = (p+q)n i ≥ 3.  2  , λ2 = (p−q)n  , λi = 0 for  |λi − λj| = min  min j(cid:54)=i  (p − q)n  2  qn,  2  (cid:19)  .  A adjacency matrix of random stochastic block model graph. p: connection probability within clusters. q < p: connection probability between clusters. n: number of nodes. v2, ¯v2: second eigenvectors of A and E[A] respectively.  11  
(cid:16) log4 n  (cid:17)  ,  n  Claim 1 (Matrix Concentration): For p ≥ O √  (cid:107)A − E[A](cid:107)2 ≤ O(  pn).  Claim 2 (Davis-Kahan): For p ≥ O  sin θ(v2, ¯v2) ≤  √ O(  pn)  minj(cid:54)=i |λi − λj|  (cid:16) log4 n  (cid:17)  ,  n  (cid:18)  application to stochastic block model  Recall: E[A] has eigenvalues λ1 = (p+q)n i ≥ 3.  2  , λ2 = (p−q)n  , λi = 0 for  |λi − λj| = min  min j(cid:54)=i  (p − q)n  2  qn,  2  (cid:19)  .  Typically, (p−q)n  2  will be the minimum of these two gaps.  A adjacency matrix of random stochastic block model graph. p: connection probability within clusters. q < p: connection probability between clusters. n: number of nodes. v2, ¯v2: second eigenvectors of A and E[A] respectively.  11  
application to stochastic block model  (cid:16) log4 n  (cid:17)  ,  n  pn).  (cid:18) √  √ p (p − q)  (cid:19)  n  , λi = 0 for  Claim 1 (Matrix Concentration): For p ≥ O √  (cid:107)A − E[A](cid:107)2 ≤ O(  Claim 2 (Davis-Kahan): For p ≥ O  (cid:16) log4 n √ minj(cid:54)=i |λi − λj| ≤ O( Recall: E[A] has eigenvalues λ1 = (p+q)n (cid:18) i ≥ 3.  sin θ(v2, ¯v2) ≤  √ O(  (cid:17)  ,  pn)  n  |λi − λj| = min  qn,  min j(cid:54)=i  pn) (p − q)n/2  = O , λ2 = (p−q)n  2  2  (cid:19)  .  (p − q)n  2  Typically, (p−q)n  2  will be the minimum of these two gaps.  A adjacency matrix of random stochastic block model graph. p: connection probability within clusters. q < p: connection probability between clusters. n: number of nodes. v2, ¯v2: second eigenvectors of A and E[A] respectively.  11  
application to stochastic block model  (cid:16) √  √ p (p−q)  n  So Far: sin θ(v2, ¯v2) ≤ O  (cid:17)  .  A adjacency matrix of random stochastic block model graph. p: connection probability within clusters. q < p: connection probability between clusters. n: number of nodes. v2, ¯v2: second eigenvectors of A and E[A] respectively.  12  
application to stochastic block model  . What does this give us?  2 ≤ O  p  (p−q)2n  (exercise).  (cid:16) √  (cid:17) So Far: sin θ(v2, ¯v2) ≤ O • Can show that this implies (cid:107)v2 − ¯v2(cid:107)2  √ p (p−q)  n  (cid:16)  (cid:17)  A adjacency matrix of random stochastic block model graph. p: connection probability within clusters. q < p: connection probability between clusters. n: number of nodes. v2, ¯v2: second eigenvectors of A and E[A] respectively.  12  
application to stochastic block model  . What does this give us?  2 ≤ O  p  (p−q)2n  (exercise).  (cid:16) √  (cid:17) So Far: sin θ(v2, ¯v2) ≤ O • Can show that this implies (cid:107)v2 − ¯v2(cid:107)2 • ¯v2 is  √ p (p−q)  n  1√ n χB,C : the community indicator vector.  (cid:16)  (cid:17)  A adjacency matrix of random stochastic block model graph. p: connection probability within clusters. q < p: connection probability between clusters. n: number of nodes. v2, ¯v2: second eigenvectors of A and E[A] respectively.  12  
application to stochastic block model  . What does this give us?  2 ≤ O  p  (p−q)2n  (exercise).  (cid:16) √  (cid:17) So Far: sin θ(v2, ¯v2) ≤ O • Can show that this implies (cid:107)v2 − ¯v2(cid:107)2 • ¯v2 is  √ p (p−q)  n  1√ n χB,C : the community indicator vector.  (cid:16)  (cid:17)  • Every i where v2(i), ¯v2(i) diﬀer in sign contributes ≥ 1  n to (cid:107)v2 − ¯v2(cid:107)2 2.  A adjacency matrix of random stochastic block model graph. p: connection probability within clusters. q < p: connection probability between clusters. n: number of nodes. v2, ¯v2: second eigenvectors of A and E[A] respectively.  12  
application to stochastic block model  . What does this give us?  2 ≤ O  p  (p−q)2n  (exercise).  (cid:16) √  (cid:17) So Far: sin θ(v2, ¯v2) ≤ O • Can show that this implies (cid:107)v2 − ¯v2(cid:107)2 • ¯v2 is  √ p (p−q)  n  1√ n χB,C : the community indicator vector.  (cid:16)  (cid:17)  • Every i where v2(i), ¯v2(i) diﬀer in sign contributes ≥ 1 • So they diﬀer in sign in at most O positions.  (cid:16) p  (p−q)2  (cid:17)  n to (cid:107)v2 − ¯v2(cid:107)2 2.  A adjacency matrix of random stochastic block model graph. p: connection probability within clusters. q < p: connection probability between clusters. n: number of nodes. v2, ¯v2: second eigenvectors of A and E[A] respectively.  12  
application to stochastic block model  Upshot: If G is a stochastic block model graph with adjacency matrix A, if we compute its second large eigenvector v2 and assign nodes to communities according to the sign pattern of this vector, we will correctly assign all but O  (cid:16) p  (cid:17)  (p−q)2  nodes.  13  
